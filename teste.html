<<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <title>Cardápio</title>

 </head>

  <body>
    <input class='file-upload-button' type="file" />

      <header>

      </header>

      <section>

      </section>

    <script>
    const header = document.querySelector('header');
    const section = document.querySelector('section');

    
    $(document).on('change', '.file-upload-button', function(event) {
      var reader = new FileReader();

      reader.onload = function(event) {
        var jsonObj = JSON.parse(event.target.result);
        var produtos = jsonObj.products;
        var categorias = jsonObj.categories;
        var estabelecimentos = jsonObj.establishments;
        var listaProdutosEstab = [];

        for (var i = 0; i < estabelecimentos.length; i++) {

          listaProdutosEstab.push(buscaProdutos(estabelecimentos[i].productsId, produtos));

        }
      alert(listaProdutosEstab);
      }         
        reader.readAsText(event.target.files[0]);
    });

    function buscaProdutos (idProdutos,listaProdutos){

      var resultadoProdutos = [];

      for (var i = 0; i < listaProdutos.length; i++) {
      
        var index =  idProdutos.indexOf(listaProdutos[i].id);
        if (index != -1){

          resultadoProdutos.push(listaProdutos[i]);
        }
      }
      return resultadoProdutos;
    }




    /*
    var requestURL = 'https://github.com/bmp85/teste/blob/b01f0a7047a494f997ce95b6b69941b77002d8ec/data.json';
    var request = new XMLHttpRequest();
    request.open('GET', requestURL);
    request.responseType = 'json';
    request.send();
    request.onload = function() 
   
    {
      var cardapioDigital = request.response;
         showProducts(cardapioDigital);
    }

function showProducts(jsonObj) {
  var produtos = jsonObj['products'];

  for (var i = 0; i < produtos.length; i++) {
    var myArticle = document.createElement('article');
    var myH2 = document.createElement('h2');
    var myPara1 = document.createElement('p');
    var myPara2 = document.createElement('p');
    var myPara3 = document.createElement('p');
    var myList = document.createElement('ul');

    myH2.textContent = produtos[i].name;
    myPara1.textContent = 'ID do produto ' + produtos[i].categoriesID;
    myPara2.textContent = 'Preço: ' + produtos[i].price;
    myPara3.textContent = 'Id:'+ produtos[i].id;

    
    myArticle.appendChild(myH2);
    myArticle.appendChild(myPara1);
    myArticle.appendChild(myPara2);
    myArticle.appendChild(myPara3);
    myArticle.appendChild(myList);

    section.appendChild(myArticle);
  }
}
 */

    </script>
  </body>
</html>